<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>é›†çµå¸ä»¤å¡”</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  font-family:sans-serif;
  background:#111;
  color:#fff;
  text-align:center;
}

/* ğŸ“± æŒ‡æ“ä½œã—ã‚„ã™ã„ãƒœã‚¿ãƒ³ */
button{
  padding:16px 22px;
  margin:6px;
  font-size:18px;
  border:none;
  border-radius:10px;
}

input{
  padding:10px;
  font-size:16px;
  border-radius:8px;
  border:none;
}

/* âœ… å‚åŠ è€…è¡Œ */
.memberRow{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  margin:8px auto;
  flex-wrap:wrap; /* â† é‡è¦ï¼šã‚¹ãƒãƒ›æŠ˜ã‚Šè¿”ã— */
  max-width:420px;
}

/* âœ… ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹å·¨å¤§åŒ– */
.memberRow input[type="checkbox"]{
  transform: scale(1.8);
  margin-right:6px;
}

/* å…¥åŠ›æ¬„ã‚µã‚¤ã‚º */
.memberRow input[type="text"]{
  width:140px;
}

.memberRow input[type="number"]{
  width:90px;
}

/* ğŸ“± å°ç”»é¢å¯¾å¿œ */
@media (max-width:480px){
  .memberRow{
    justify-content:flex-start;
    padding-left:10px;
  }
  .memberRow input[type="text"]{
    width:120px;
  }
  .memberRow input[type="number"]{
    width:80px;
  }
}

.timer{
  font-size:64px;
  margin:15px;
}

.result{
  white-space:pre-line;
  color:#7CFC00;
  margin-top:10px;
}

.section{display:none;margin-top:15px;}
.active{background:#0af;color:#fff;}
</style>
</head>
<body>

<h1>ğŸ›° é›†çµå¸ä»¤å¡”</h1>

<h3>å‚åŠ è€…</h3>
<div id="memberList"></div>
<button onclick="addRow()">ï¼‹å‚åŠ è€…è¿½åŠ </button>

<div class="tab">
<button onclick="showTab('up')" class="active">ğŸŸ¥ ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—</button>
<button onclick="showTab('down')">ğŸŸ¦ ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³</button>
<button onclick="showTab('utc')">ğŸŒ UTCå‡ºç™ºè¨ˆç®—</button>
</div>

<!-- ä»¥é™ã®HTMLã¨JSã¯ãã®ã¾ã¾ -->
<div id="up" class="section" style="display:block;">
<h2>ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—</h2>
<button onclick="calcUp()">è¨ˆç®—</button>
<div class="timer" id="upTimer">-</div>
<button onclick="startUp()">é–‹å§‹</button>
<button onclick="stopAll()">åœæ­¢</button>
<div class="result" id="upResult"></div>
<button onclick="copyResult('upResult')">çµæœã‚³ãƒ”ãƒ¼</button>
</div>

<div id="down" class="section">
<h2>ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³</h2>
<button onclick="calcDown()">è¨ˆç®—</button>
<div class="timer" id="downTimer">-</div>
<button onclick="startDown()">é–‹å§‹</button>
<button onclick="stopAll()">åœæ­¢</button>
<div class="result" id="downResult"></div>
<button onclick="copyResult('downResult')">çµæœã‚³ãƒ”ãƒ¼</button>
</div>

<div id="utc" class="section">
<h2>UTCå‡ºç™ºè¨ˆç®—</h2>

åˆ°ç€UTC:
<input type="number" id="h" placeholder="æ™‚">
<input type="number" id="m" placeholder="åˆ†">
<input type="number" id="s" placeholder="ç§’">

<br><br>
å¾…æ©Ÿæ™‚é–“ï¼ˆåˆ†ï¼‰:
<input type="number" id="wait" min="0" max="60" value="0">

<br><br>
<button onclick="calcUTC()">è¨ˆç®—</button>
<div class="result" id="utcResult"></div>
<button onclick="copyResult('utcResult')">çµæœã‚³ãƒ”ãƒ¼</button>
</div>

<script>
let upInterval, downInterval;

/* ğŸ”Š éŸ³ */
function beep(freq=800,duration=100){
 const ctx=new (window.AudioContext||window.webkitAudioContext)();
 const osc=ctx.createOscillator();
 const gain=ctx.createGain();
 osc.connect(gain);
 gain.connect(ctx.destination);
 osc.frequency.value=freq;
 osc.start();
 gain.gain.setValueAtTime(0.2,ctx.currentTime);
 osc.stop(ctx.currentTime+duration/1000);
}

/* è¡Œè¿½åŠ  */
function addRow(name="",time=""){
 const row=document.createElement("div");
 row.className="memberRow";
 row.innerHTML=`
   <input type="checkbox" checked>
   <input placeholder="åå‰" value="${name}">
   <input type="number" placeholder="ç§’" value="${time}">
 `;
 document.getElementById("memberList").appendChild(row);
}

/* åˆæœŸè¡Œ */
addRow();

/* é¸æŠã•ã‚ŒãŸå‚åŠ è€…å–å¾— */
function getMembers(){
 const rows=document.querySelectorAll(".memberRow");
 let list=[];
 rows.forEach(r=>{
   const checked=r.children[0].checked;
   const name=r.children[1].value || "å‚åŠ è€…";
   const time=parseInt(r.children[2].value);
   if(checked && !isNaN(time)){
     list.push({name,time});
   }
 });
 return list;
}

/* ã‚¿ãƒ– */
function showTab(id){
 document.querySelectorAll('.section').forEach(s=>s.style.display="none");
 document.getElementById(id).style.display="block";
 document.querySelectorAll('.tab button').forEach(b=>b.classList.remove('active'));
 event.target.classList.add('active');
}

/* ğŸŸ¥ ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ— */
let upTimes=[];
function calcUp(){
 const members=getMembers();
 if(members.length===0)return;
 const max=Math.max(...members.map(m=>m.time));
 upTimes=members.map(m=>({name:m.name,start:max-m.time}));
 let text="æº–å‚™3ç§’ â†’ å‡ºç™º\n";
 upTimes.forEach(p=>text+=`${p.name}: ${p.start}ç§’\n`);
 upResult.innerText=text;
}

function startUp(){
 let t=-3;
 const end=Math.max(...upTimes.map(p=>p.start));
 clearInterval(upInterval);
 upInterval=setInterval(()=>{
   upTimer.innerText=t;
   beep();
   if(t>=end){ beep(1200,300); clearInterval(upInterval);}
   t++;
 },1000);
}

/* ğŸŸ¦ ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ */
let downTimes=[];
function calcDown(){
 const members=getMembers();
 if(members.length===0)return;
 const min=Math.min(...members.map(m=>m.time));
 downTimes=members.map(m=>({name:m.name,start:m.time-min}));
 const max=Math.max(...downTimes.map(p=>p.start));
 const total=max+3;
 downTimer.innerText=total;
 let text=`ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ ${total} ç§’\n`;
 downTimes.forEach(p=>text+=`${p.name}: ${p.start}ç§’\n`);
 downResult.innerText=text;
}

function startDown(){
 let t=parseInt(downTimer.innerText);
 clearInterval(downInterval);
 downInterval=setInterval(()=>{
   downTimer.innerText=t;
   beep();
   if(t<=0){ beep(1200,300); clearInterval(downInterval);}
   t--;
 },1000);
}

/* ğŸŒ UTC */
function calcUTC(){
 const members=getMembers();
 if(members.length===0)return;

 const h=parseInt(h.value)||0;
 const m=parseInt(m.value)||0;
 const s=parseInt(s.value)||0;
 const wait=parseInt(wait.value)||0;

 const arrival=h*3600+m*60+s;

 let text="å‡ºç™ºUTC\n";
 members.forEach(mem=>{
   let depart=arrival-(mem.time+wait*60);
   depart=(depart+86400)%86400;
   const hh=String(Math.floor(depart/3600)).padStart(2,'0');
   const mm=String(Math.floor((depart%3600)/60)).padStart(2,'0');
   const ss=String(depart%60).padStart(2,'0');
   text+=`${mem.name}: ${hh}:${mm}:${ss}\n`;
 });
 utcResult.innerText=text;
}

/* åœæ­¢ */
function stopAll(){
 clearInterval(upInterval);
 clearInterval(downInterval);
 upTimer.innerText="-";
 downTimer.innerText="-";
}

/* ã‚³ãƒ”ãƒ¼ */
function copyResult(id){
 navigator.clipboard.writeText(document.getElementById(id).innerText);
 alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
}
</script>
</body>
</html>

