<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>é›†çµå¸ä»¤å¡”</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  font-family:sans-serif;
  background:#111;
  color:#fff;
  text-align:center;
}
.tab button{
  padding:10px;
  margin:3px;
  font-size:14px;
  border:none;
  border-radius:6px;
}
.active{background:#0af;color:#fff;}
.section{display:none;margin-top:15px;}
.timer{font-size:48px;margin:10px;}
.result{white-space:pre-line;color:#7CFC00;margin-top:10px;}
input,button,select{
  padding:8px;
  margin:4px;
  font-size:16px;
}
</style>
</head>
<body>

<h1>ğŸ›° é›†çµå¸ä»¤å¡”</h1>

<h3>å‚åŠ è€…ã¨ç§»å‹•æ™‚é–“ï¼ˆç§’ï¼‰</h3>
<input id="name" placeholder="åå‰">
<input id="time" type="number" placeholder="ç§’">
<button onclick="add()">è¿½åŠ </button>
<p id="members"></p>

<div class="tab">
<button onclick="showTab('up')" class="active">ğŸŸ¥ ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—</button>
<button onclick="showTab('down')">ğŸŸ¦ ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³</button>
<button onclick="showTab('utc')">ğŸŒ UTCå‡ºç™ºè¨ˆç®—</button>
</div>

<div id="up" class="section" style="display:block;">
<h2>ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—ï¼ˆé ï¼‰</h2>
<button onclick="calcUp()">è¨ˆç®—</button>
<div class="timer" id="upTimer">-</div>
<button onclick="startUp()">é–‹å§‹</button>
<button onclick="stopAll()">åœæ­¢</button>
<div class="result" id="upResult"></div>
<button onclick="copyResult('upResult')">çµæœã‚³ãƒ”ãƒ¼</button>
</div>

<div id="down" class="section">
<h2>ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ï¼ˆè¿‘ï¼‰</h2>
<button onclick="calcDown()">è¨ˆç®—</button>
<div class="timer" id="downTimer">-</div>
<button onclick="startDown()">é–‹å§‹</button>
<button onclick="stopAll()">åœæ­¢</button>
<div class="result" id="downResult"></div>
<button onclick="copyResult('downResult')">çµæœã‚³ãƒ”ãƒ¼</button>
</div>

<div id="utc" class="section">
<h2>UTCå‡ºç™ºè¨ˆç®—</h2>
  
<label>ç§»å‹•æ™‚é–“ï¼ˆç§’ï¼‰</label>
<input id="travelTime" type="number">

<label>å¾…æ©Ÿæ™‚é–“ï¼ˆåˆ†ï¼‰</label>
<input id="wait" type="number" min="0" max="60" value="0">

<label>å¾®èª¿æ•´ï¼ˆç§’ï¼‰</label>
<select id="adjust">

åˆ°ç€UTC:
<input type="number" id="h" min="0" max="23" placeholder="æ™‚">
<input type="number" id="m" min="0" max="59" placeholder="åˆ†">
<input type="number" id="s" min="0" max="59" placeholder="ç§’">

<br><br>
å¾®èª¿æ•´:
<select id="adj">
<option value="-5">-5</option>
<option value="-4">-4</option>
<option value="-3">-3</option>
<option value="-2">-2</option>
<option value="-1">-1</option>
<option value="0" selected>0</option>
<option value="1">+1</option>
<option value="2">+2</option>
<option value="3">+3</option>
<option value="4">+4</option>
<option value="5">+5</option>
</select>

<br><br>
<button onclick="calcUTC()">è¨ˆç®—</button>
<div class="result" id="utcResult"></div>
<button onclick="copyResult('utcResult')">çµæœã‚³ãƒ”ãƒ¼</button>
</div>

<script>
let members=[];
let upTimes=[],downTimes=[];
let upInterval,downInterval;

function add(){
 const n = document.getElementById("name").value || ("å‚åŠ è€…"+(members.length+1));
 const t = parseInt(document.getElementById("time").value);

 if(!isNaN(t)){
   members.push({name:n,time:t});
   members.sort((a,b)=>a.time-b.time);

   document.getElementById("members").innerText =
     members.map(m=>m.name+"("+m.time+"s)").join(" / ");
 }
}
document.getElementById("name").value="";
document.getElementById("time").value="";
  
function showTab(id){
 document.querySelectorAll('.section').forEach(s=>s.style.display="none");
 document.getElementById(id).style.display="block";
 document.querySelectorAll('.tab button').forEach(b=>b.classList.remove('active'));
 event.currentTarget.classList.add('active');
}

function calcUTC(){
 if(members.length===0) return;

 const hour = parseInt(document.getElementById("h").value) || 0;
 const min  = parseInt(document.getElementById("m").value) || 0;
 const sec  = parseInt(document.getElementById("s").value) || 0;
 const wait = parseInt(document.getElementById("wait").value) || 0;
 const adj  = parseInt(document.getElementById("adj").value) || 0;

 const now = new Date();

 let target = new Date(now);
 target.setHours(hour, min, sec, 0);

 // ã™ã§ã«éãã¦ã„ãŸã‚‰ç¿Œæ—¥
 if(target < now) target.setDate(target.getDate()+1);

 // å¾…æ©Ÿæ™‚é–“è¿½åŠ 
 target.setMinutes(target.getMinutes() + wait);

 // å¾®èª¿æ•´ç§’
 target.setSeconds(target.getSeconds() + adj);

 const diff = Math.floor((target - now)/1000);

 document.getElementById("result").innerText =
  `UTCå‡ºç™ºæ™‚åˆ»\n${target.toTimeString().split(' ')[0]}\n\nå‡ºç™ºã¾ã§ ${diff} ç§’`;
}

function startUp(){
 let t=-3;
 const end=Math.max(...upTimes.map(p=>p.start));
 clearInterval(upInterval);
 upInterval=setInterval(()=>{
   upTimer.innerText=t;
   if(t>=end) clearInterval(upInterval);
   t++;
 },1000);
}

function calcUp(){
 if(members.length===0) return;

 const result = members.map(m => `${m.name} +${m.time}ç§’`).join('\n');

 const total = members.reduce((sum,m)=>sum+m.time,0);

 document.getElementById("result").innerText =
  `ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—\nåˆè¨ˆ ${total} ç§’\n\n${result}`;
}
  
function calcDown(){
 if(members.length===0) return;

 const min = Math.min(...members.map(m=>m.time));
 downTimes = members.map(m=>({name:m.name,start:m.time-min}));

 const max = Math.max(...downTimes.map(p=>p.start));
 const countdownTotal = max + 3;

 document.getElementById("downTimer").innerText = countdownTotal;

 let text = `ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ ${countdownTotal} ç§’\n`;

 downTimes.forEach(p=>{
   text += `${p.name}: ${p.start}ç§’\n`;
 });

 document.getElementById("downResult").innerText = text;
}

function startDown(){
 let t=parseInt(downTimer.innerText);
 clearInterval(downInterval);
 downInterval=setInterval(()=>{
   downTimer.innerText=t;
   if(t<=0) clearInterval(downInterval);
   t--;
 },1000);
}

function stopAll(){
 clearInterval(upInterval);
 clearInterval(downInterval);
 upTimer.innerText="-";
 downTimer.innerText="-";
}

function copyResult(id){
 navigator.clipboard.writeText(document.getElementById(id).innerText);
 alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
}
</script>
</body>
</html>





